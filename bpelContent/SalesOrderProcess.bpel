<!-- SalesOrderProcess BPEL Process [Generated by the Eclipse BPEL Designer] -->
<!-- Date: Mon Mar 19 17:42:23 PKT 2018 -->
<bpel:process name="SalesOrderProcess"
         targetNamespace="salesorder"
         suppressJoinFailure="yes"
         xmlns:tns="salesorder"
         xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
         xmlns:ns1="http://www.w3.org/2001/XMLSchema" xmlns:ns="http://createCartForCustomer.ofbiz.ws" xmlns:ns0="http://searchproduct.ofbiz.com" xmlns:ns2="http://getProductInventoryAvailable.ofbiz.com" xmlns:ns3="http://addcartitem.ofbiz.com" xmlns:ns4="http://cartshippingsettings.ofbiz.com" xmlns:ns5="http://cartpaymentpreference.ofbiz.com" xmlns:ns6="http://taxServices.sample.ws" xmlns:ns7="http://shippingServices.sample.ws" xmlns:ns8="http://getcartcontents.ofbiz.com" xmlns:ns9="http://createCustomerOrder.ofbiz.com" xmlns:ns10="http://createinvoice.ofbiz.com">

    <!-- Import the client WSDL -->
    <bpel:import namespace="http://createinvoice.ofbiz.com" location="CreateInvoice.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>
    <bpel:import namespace="http://taxServices.sample.ws" location="CalculateSalesTax.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>
    <bpel:import namespace="http://cartshippingsettings.ofbiz.com" location="CartShippingSettings.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>
    <bpel:import namespace="http://addcartitem.ofbiz.com" location="AddCartItem.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>
    <bpel:import namespace="http://searchproduct.ofbiz.com" location="SearchProduct.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>
    <bpel:import namespace="http://createCartForCustomer.ofbiz.ws" location="CreateCartForCustomer.wsdl" importType="http://schemas.xmlsoap.org/wsdl/"></bpel:import>
    <bpel:import location="SalesOrderProcessArtifacts.wsdl" namespace="salesorder" 
	        importType="http://schemas.xmlsoap.org/wsdl/" />
         
    <!-- ================================================================= -->         
    <!-- PARTNERLINKS                                                      -->
    <!-- List of services participating in this BPEL process               -->
    <!-- ================================================================= -->         
    <bpel:partnerLinks>
        <!-- The 'client' role represents the requester of this service. -->
        <bpel:partnerLink name="client"
                     partnerLinkType="tns:SalesOrderProcess"
                     myRole="SalesOrderProcessProvider"
                     />
        <bpel:partnerLink name="CreateCartForCustomerServicePL" partnerLinkType="tns:CreateCartForCustomerServicePLT" partnerRole="CreateCartForCustomerServicePLR"></bpel:partnerLink>
        <bpel:partnerLink name="SearchProductServicePL" partnerLinkType="tns:SearchProductServicePLT" partnerRole="SearchProductServicePLR"></bpel:partnerLink>
        <bpel:partnerLink name="GetProductInventoryAvailableServicePL" partnerLinkType="tns:GetProductInventoryAvailableServicePLT" partnerRole="GetProductInventoryAvailableServicePLR"></bpel:partnerLink>
        <bpel:partnerLink name="AddCartItemServicePL" partnerLinkType="tns:AddCartItemServicePLT" partnerRole="AddCartItemServicePLR"></bpel:partnerLink>
        <bpel:partnerLink name="CartShippingSettingsPL" partnerLinkType="tns:CartShippingSettingsPLT" partnerRole="CartShippingSettingsPLR"></bpel:partnerLink>
        <bpel:partnerLink name="UpdateCartPaymentPreferencePL" partnerLinkType="tns:UpdateCartPaymentPreferencePLT" partnerRole="UpdateCartPaymentPreferencePLR"></bpel:partnerLink>
        <bpel:partnerLink name="CalculateSalesTaxServicePL" partnerLinkType="tns:CalculateSalesTaxServicePLT" partnerRole="CalculateSalesTaxServicePLR"></bpel:partnerLink>
        <bpel:partnerLink name="CalculateShippingServicePL" partnerLinkType="tns:CalculateShippingServicePLT" partnerRole="CalculateShippingServicePLR"></bpel:partnerLink>
        <bpel:partnerLink name="GetCartContentServicePL" partnerLinkType="tns:GetContentServicePLT" partnerRole="GetContentServicePLR"></bpel:partnerLink>
        <bpel:partnerLink name="CreateOrderServicePL" partnerLinkType="tns:CreateOrderServicePLT" partnerRole="CreateOrderServicePLR"></bpel:partnerLink>
        <bpel:partnerLink name="CreatInvoiceServicePL" partnerLinkType="tns:CreatInvoiceServicePLT" partnerRole="CreatInvoiceServicePLR"></bpel:partnerLink>
    </bpel:partnerLinks>
  
    <!-- ================================================================= -->         
    <!-- VARIABLES                                                         -->
    <!-- List of messages and XML documents used within this BPEL process  -->
    <!-- ================================================================= -->         
    <bpel:variables>
        <!-- Reference to the message passed as input during initiation -->
        <bpel:variable name="input"
                  messageType="tns:SalesOrderProcessRequestMessage"/>
                  
        <!-- 
          Reference to the message that will be returned to the requester
          -->
        <bpel:variable name="output"
                  messageType="tns:SalesOrderProcessResponseMessage"/>
        <bpel:variable name="customerID" type="ns1:string"></bpel:variable>
        <bpel:variable name="firstName" type="ns1:string"></bpel:variable>
        <bpel:variable name="lastName" type="ns1:string"></bpel:variable>
        <bpel:variable name="cartID" type="ns1:string"></bpel:variable>
        <bpel:variable name="CreateCartForCustomerServicePLResponse" messageType="ns:createCartForCustomerResponse"></bpel:variable>
        <bpel:variable name="CreateCartForCustomerServicePLRequest" messageType="ns:createCartForCustomerRequest"></bpel:variable>
        <bpel:variable name="productName" type="ns1:string"></bpel:variable>
        <bpel:variable name="productID" type="ns1:string"></bpel:variable>
        <bpel:variable name="description" type="ns1:string"></bpel:variable>
        <bpel:variable name="inventoryItemID" type="ns1:string"></bpel:variable>
        <bpel:variable name="taxClassID" type="ns1:string"></bpel:variable>
        <bpel:variable name="categoryID" type="ns1:string"></bpel:variable>
        <bpel:variable name="price" type="ns1:string"></bpel:variable>
        <bpel:variable name="InputSearchProductRequest" messageType="tns:searchProductRequest"></bpel:variable>
        <bpel:variable name="OutputSearchProductResponse" messageType="tns:searchProductResponse"></bpel:variable>
        <bpel:variable name="SearchProductServicePLResponse" messageType="ns0:searchProductResponse"></bpel:variable>
        <bpel:variable name="SearchProductServicePLRequest" messageType="ns0:searchProductRequest"></bpel:variable>
        <bpel:variable name="InputGetProductInventoryAvailableRequest" messageType="tns:getProductInventoryAvailableRequest"></bpel:variable>
        <bpel:variable name="OutputGetProductInventoryAvailableResponse" messageType="tns:getProductInventoryAvailableResponse"></bpel:variable>
        <bpel:variable name="GetProductInventoryAvailableServicePLResponse" messageType="ns2:getProductInventoryAvailableResponse"></bpel:variable>
        <bpel:variable name="GetProductInventoryAvailableServicePLRequest" messageType="ns2:getProductInventoryAvailableRequest"></bpel:variable>
        <bpel:variable name="quantity" type="ns1:double"></bpel:variable>
        <bpel:variable name="shipAfterDate" type="ns1:string"></bpel:variable>
        <bpel:variable name="isAvailable" type="ns1:boolean"></bpel:variable>
        <bpel:variable name="InputAddCartItemRequest" messageType="tns:AddCartItemRequest"></bpel:variable>
        <bpel:variable name="OutputAddCartItemResponse" messageType="tns:AddCartItemResponse"></bpel:variable>
        <bpel:variable name="AddCartItemServicePLResponse" messageType="ns3:addCartItemResponse"></bpel:variable>
        <bpel:variable name="AddCartItemServicePLRequest" messageType="ns3:addCartItemRequest"></bpel:variable>
        <bpel:variable name="cartItemSeqID" type="ns1:string"></bpel:variable>
        <bpel:variable name="InputCartShippingSettingsRequest" messageType="tns:UpdateShippingPreferenceRequest"></bpel:variable>
        <bpel:variable name="OutputCartShippingSettingsResponse" messageType="tns:UpdateShippingPreferenceResponse"></bpel:variable>
        <bpel:variable name="CartShippingSettingsPLResponse" messageType="ns4:updateCartShippingSettingsResponse"></bpel:variable>
        <bpel:variable name="CartShippingSettingsPLRequest" messageType="ns4:updateCartShippingSettingsRequest"></bpel:variable>
        <bpel:variable name="shipToName" type="ns1:string"></bpel:variable>
        <bpel:variable name="address" type="ns1:string"></bpel:variable>
        <bpel:variable name="city" type="ns1:string"></bpel:variable>
        <bpel:variable name="postalCode" type="ns1:string"></bpel:variable>
        <bpel:variable name="countryGeoID" type="ns1:string"></bpel:variable>
        <bpel:variable name="stateProvinceGeoID" type="ns1:string"></bpel:variable>
        <bpel:variable name="telephone" type="ns1:string"></bpel:variable>
        <bpel:variable name="email" type="ns1:string"></bpel:variable>
        <bpel:variable name="carrierPartyID" type="ns1:string"></bpel:variable>
        <bpel:variable name="shipmentMehodTypeID" type="ns1:string"></bpel:variable>
        
        <bpel:variable name="InputUpdateCartPaymentPreferenceRequest" messageType="tns:updateCartPaymentPreferenceRequest"></bpel:variable>
        <bpel:variable name="OutputUpdateCartPaymentPreferenceResponse" messageType="tns:updateCartPaymentPreferenceResponse"></bpel:variable>
        <bpel:variable name="UpdateCartPaymentPreferencePLResponse" messageType="ns5:updateCartPaymentPreferenceResponse"></bpel:variable>
        <bpel:variable name="UpdateCartPaymentPreferencePLRequest" messageType="ns5:updateCartPaymentPreferenceRequest"></bpel:variable>
        <bpel:variable name="currency" type="ns1:string"></bpel:variable>
        <bpel:variable name="issueNumber" type="ns1:string"></bpel:variable>
        <bpel:variable name="cardNumber" type="ns1:string"></bpel:variable>
        <bpel:variable name="cardType" type="ns1:string"></bpel:variable>
        <bpel:variable name="expirationYear" type="ns1:string"></bpel:variable>
        <bpel:variable name="expirationMonth" type="ns1:string"></bpel:variable>
        <bpel:variable name="paymentMethod" type="ns1:string"></bpel:variable>
        <bpel:variable name="TaxAmount" type="ns1:string"></bpel:variable>
        <bpel:variable name="TaxRate" type="ns1:string"></bpel:variable>
        <bpel:variable name="InputCalculateSalesTaxRequest" messageType="tns:calcualateSalesTaxRequest"></bpel:variable>
        <bpel:variable name="OutputCalculateSalesTaxResponse" messageType="tns:calcualateSalesTaxResponse"></bpel:variable>
        <bpel:variable name="CalculateSalesTaxServicePLResponse" messageType="ns6:calculateSalesTaxResponse"></bpel:variable>
        <bpel:variable name="CalculateSalesTaxServicePLRequest" messageType="ns6:calculateSalesTaxRequest"></bpel:variable>
        <bpel:variable name="InputCalculateShippingRequest" messageType="tns:calculateShippingRequest"></bpel:variable>
        <bpel:variable name="OutputCalculateShippingResponse" messageType="tns:calculateShippingResponse"></bpel:variable>
        <bpel:variable name="CalculateShippingServicePLResponse" messageType="ns7:calc_shippingResponse"></bpel:variable>
        <bpel:variable name="CalculateShippingServicePLRequest" messageType="ns7:calc_shippingRequest"></bpel:variable>
        <bpel:variable name="shipmentCostEstimate" type="ns1:string"></bpel:variable>
        <bpel:variable name="InputGetCartContentRequest" messageType="tns:getCartContentRequest"></bpel:variable>
        <bpel:variable name="OutputGetCartContentResponse" messageType="tns:getCartContentResponse"></bpel:variable>
        <bpel:variable name="GetCartContentServicePLResponse" messageType="ns8:getCartContentsResponse"></bpel:variable>
        <bpel:variable name="GetCartContentServicePLRequest" messageType="ns8:getCartContentsRequest"></bpel:variable>
        <bpel:variable name="count" type="ns1:int"></bpel:variable>
        <bpel:variable name="InputCreateOrderRequest" messageType="tns:createOrderRequest"></bpel:variable>
        <bpel:variable name="OutputCreateOrderResponse" messageType="tns:createOrderResponse"></bpel:variable>
        <bpel:variable name="CreateOrderServicePLResponse" messageType="ns9:createOrderResponse"></bpel:variable>
        <bpel:variable name="CreateOrderServicePLRequest" messageType="ns9:createOrderRequest"></bpel:variable>
        <bpel:variable name="orderID" type="ns1:string"></bpel:variable>
        <bpel:variable name="statusID" type="ns1:string"></bpel:variable>
        <bpel:variable name="InputCreateInvoiceRequest" messageType="tns:createInvoiceRequest"></bpel:variable>
        <bpel:variable name="OutputCreateInvoiceResponse" messageType="tns:createInvoiceResponse"></bpel:variable>
        <bpel:variable name="CreatInvoiceServicePLResponse" messageType="ns10:createInvoiceResponse"></bpel:variable>
        <bpel:variable name="CreatInvoiceServicePLRequest" messageType="ns10:createInvoiceRequest"></bpel:variable>
        <bpel:variable name="totalAmount" type="ns1:double"></bpel:variable>
        <bpel:variable name="invoiceID" type="ns1:string"></bpel:variable>
        <bpel:variable name="invoiceDate" type="ns1:string"></bpel:variable>
    </bpel:variables>

    <!-- ================================================================= -->         
    <!-- ORCHESTRATION LOGIC                                               -->
    <!-- Set of activities coordinating the flow of messages across the    -->
    <!-- services integrated within this business process                  -->
    <!-- ================================================================= -->         
    <bpel:correlationSets>
        <bpel:correlationSet name="CorrelationSet" properties="tns:property"></bpel:correlationSet>
        
    </bpel:correlationSets>
    <bpel:sequence name="main">
        
        <!-- Receive input from requester. 
             Note: This maps to operation defined in SalesOrderProcess.wsdl 
             -->
        <bpel:receive name="receiveInputsCreateCartForCustomer" partnerLink="client"
                 portType="tns:SalesOrderProcess"
                 operation="createCartForCustomer" variable="input"
                 createInstance="yes">
            <bpel:correlations>
                <bpel:correlation set="CorrelationSet" initiate="yes"></bpel:correlation>
            </bpel:correlations>
        </bpel:receive>
        
        <!-- Generate reply to synchronous request -->
        <bpel:assign validate="no" name="AssignInputsCreatCartForCustomer">
            <bpel:copy>
                <bpel:from><bpel:literal><impl:createCartForCustomer xmlns:impl="http://createCartForCustomer.ofbiz.ws" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <impl:createCartForCustomerInput>
    <impl:customerId>impl:customerId</impl:customerId>
    <impl:firstName>impl:firstName</impl:firstName>
    <impl:lastName>impl:lastName</impl:lastName>
  </impl:createCartForCustomerInput>
</impl:createCartForCustomer>
</bpel:literal></bpel:from>
                <bpel:to variable="CreateCartForCustomerServicePLRequest" part="parameters"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="payload" variable="input">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:CustomerID]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="customerID"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="payload" variable="input">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:FirstName]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="firstName"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="payload" variable="input">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:LastName]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="lastName"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="customerID"></bpel:from>
                <bpel:to part="parameters" variable="CreateCartForCustomerServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[ns:createCartForCustomerInput/ns:customerId]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="firstName"></bpel:from>
                <bpel:to part="parameters" variable="CreateCartForCustomerServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns:createCartForCustomerInput/ns:firstName]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="lastName"></bpel:from>
                <bpel:to part="parameters" variable="CreateCartForCustomerServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns:createCartForCustomerInput/ns:lastName]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
        </bpel:assign>
        <bpel:invoke name="InvokeCreateCartForCustomerService" partnerLink="CreateCartForCustomerServicePL" operation="createCartForCustomer" portType="ns:CreateCartForCustomer" inputVariable="CreateCartForCustomerServicePLRequest" outputVariable="CreateCartForCustomerServicePLResponse"></bpel:invoke>
        <bpel:assign validate="no" name="AssignOutputsCreateCartForCustomer">
            <bpel:copy>
                <bpel:from><bpel:literal><tns:SalesOrderProcessResponse xmlns:tns="salesorder" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <tns:CartID>tns:CartID</tns:CartID>
</tns:SalesOrderProcessResponse>
</bpel:literal></bpel:from>
                <bpel:to variable="output" part="payload"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="CreateCartForCustomerServicePLResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns:createCartForCustomerReturn/ns:cartId]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="cartID"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="cartID"></bpel:from>
                <bpel:to part="payload" variable="output">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:CartID]]></bpel:query>
                </bpel:to>
            </bpel:copy>
        </bpel:assign>
        <bpel:reply name="replyOutputCreateCartForCustomer" 
               partnerLink="client"
               portType="tns:SalesOrderProcess"
               operation="createCartForCustomer" 
               variable="output"
               />
        <bpel:receive name="ReceiveInputsSearchProduct" partnerLink="client" operation="searchProduct" portType="tns:SalesOrderProcess" variable="InputSearchProductRequest">
            <bpel:correlations>
                <bpel:correlation set="CorrelationSet" initiate="no"></bpel:correlation>
            </bpel:correlations>
        </bpel:receive>
        <bpel:assign validate="no" name="AssignInputsSearchProduct">
            <bpel:copy>
                <bpel:from><bpel:literal><impl:searchProduct xmlns:impl="http://searchproduct.ofbiz.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <impl:searchProductInput>
    <impl:name>impl:name</impl:name>
  </impl:searchProductInput>
</impl:searchProduct>
</bpel:literal></bpel:from>
                <bpel:to variable="SearchProductServicePLRequest" part="parameters"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="InputSearchProductRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:ProductName]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="productName"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="productName"></bpel:from>
                <bpel:to part="parameters" variable="SearchProductServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns0:searchProductInput/ns0:name]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
        </bpel:assign>
        <bpel:invoke name="InvokeSearchProductService" partnerLink="SearchProductServicePL" operation="searchProduct" portType="ns0:SearchProduct" inputVariable="SearchProductServicePLRequest" outputVariable="SearchProductServicePLResponse"></bpel:invoke>
        <bpel:assign validate="no" name="AssignOutputsSearchProductService">
            <bpel:copy>
                <bpel:from><bpel:literal><tns:searchProductResponse xmlns:tns="salesorder" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <tns:ProductID>tns:ProductID</tns:ProductID>
  <tns:Description>tns:Description</tns:Description>
  <tns:InventoryItemID>tns:InventoryItemID</tns:InventoryItemID>
  <tns:TaxClassID>tns:TaxClassID</tns:TaxClassID>
  <tns:CategoryID>tns:CategoryID</tns:CategoryID>
  <tns:Price>tns:Price</tns:Price>
</tns:searchProductResponse>
</bpel:literal></bpel:from>
                <bpel:to variable="OutputSearchProductResponse" part="parameters"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="SearchProductServicePLResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns0:searchProductReturn/ns0:productId]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="productID"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="SearchProductServicePLResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns0:searchProductReturn/ns0:description]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="description"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="SearchProductServicePLResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns0:searchProductReturn/ns0:inventoryItemId]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="inventoryItemID"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="SearchProductServicePLResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns0:searchProductReturn/ns0:taxClassId]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="taxClassID"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="SearchProductServicePLResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns0:searchProductReturn/ns0:categoryId]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="categoryID"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="SearchProductServicePLResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns0:searchProductReturn/ns0:price]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="price"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="productID"></bpel:from>
                <bpel:to part="parameters" variable="OutputSearchProductResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:ProductID]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="description"></bpel:from>
                <bpel:to part="parameters" variable="OutputSearchProductResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:Description]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="inventoryItemID"></bpel:from>
                <bpel:to part="parameters" variable="OutputSearchProductResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:InventoryItemID]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="taxClassID"></bpel:from>
                <bpel:to part="parameters" variable="OutputSearchProductResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:TaxClassID]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="categoryID"></bpel:from>
                <bpel:to part="parameters" variable="OutputSearchProductResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:CategoryID]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="price"></bpel:from>
                <bpel:to part="parameters" variable="OutputSearchProductResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:Price]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
        </bpel:assign>
        <bpel:reply name="ReplyOutputsSearchProduct" partnerLink="client" operation="searchProduct" portType="tns:SalesOrderProcess" variable="OutputSearchProductResponse"></bpel:reply>
        <bpel:receive name="ReceiveInputsGetProductInventoryAvailable" partnerLink="client" operation="getProductInventoryAvailable" portType="tns:SalesOrderProcess" variable="InputGetProductInventoryAvailableRequest">
            <bpel:correlations>
                <bpel:correlation set="CorrelationSet" initiate="no"></bpel:correlation>
            </bpel:correlations>
        </bpel:receive>
        <bpel:assign validate="no" name="AssignInputsGetProductInventoryAvailable">
            <bpel:copy>
                <bpel:from><bpel:literal><impl:getProductInventoryAvailable xmlns:impl="http://getProductInventoryAvailable.ofbiz.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <impl:getProductInventoryAvailableInput>
    <impl:productId>impl:productId</impl:productId>
    <impl:inventoryItemId>impl:inventoryItemId</impl:inventoryItemId>
    <impl:shipAfterDate>impl:shipAfterDate</impl:shipAfterDate>
    <impl:quantity>0.0</impl:quantity>
  </impl:getProductInventoryAvailableInput>
</impl:getProductInventoryAvailable>
</bpel:literal></bpel:from>
                <bpel:to variable="GetProductInventoryAvailableServicePLRequest" part="parameters"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="InputGetProductInventoryAvailableRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:Quantity]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="quantity"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="InputGetProductInventoryAvailableRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:ShipAfterDate]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="shipAfterDate"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="productID"></bpel:from>
                <bpel:to part="parameters" variable="GetProductInventoryAvailableServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns2:getProductInventoryAvailableInput/ns2:productId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="inventoryItemID"></bpel:from>
                <bpel:to part="parameters" variable="GetProductInventoryAvailableServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns2:getProductInventoryAvailableInput/ns2:inventoryItemId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="shipAfterDate"></bpel:from>
                <bpel:to part="parameters" variable="GetProductInventoryAvailableServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns2:getProductInventoryAvailableInput/ns2:shipAfterDate]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="quantity"></bpel:from>
                <bpel:to part="parameters" variable="GetProductInventoryAvailableServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns2:getProductInventoryAvailableInput/ns2:quantity]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
        </bpel:assign>
        <bpel:invoke name="InvokeGetProductInventoryAvailable" partnerLink="GetProductInventoryAvailableServicePL" operation="getProductInventoryAvailable" portType="ns2:GetProductInventoryAvailable" inputVariable="GetProductInventoryAvailableServicePLRequest" outputVariable="GetProductInventoryAvailableServicePLResponse"></bpel:invoke>
        <bpel:assign validate="no" name="AssignOutputsGetProductInventoryAvailable">
            <bpel:copy>
                <bpel:from><bpel:literal><tns:getProductInventoryAvailableResponse xmlns:tns="salesorder" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <tns:IsAvailable>true</tns:IsAvailable>
</tns:getProductInventoryAvailableResponse>
</bpel:literal></bpel:from>
                <bpel:to variable="OutputGetProductInventoryAvailableResponse" part="parameters"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="GetProductInventoryAvailableServicePLResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns2:getProductInventoryAvailableReturn/ns2:isAvailable]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="isAvailable"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="isAvailable"></bpel:from>
                <bpel:to part="parameters" variable="OutputGetProductInventoryAvailableResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:IsAvailable]]></bpel:query>
                </bpel:to>
            </bpel:copy>
        </bpel:assign>
        <bpel:reply name="ReplyOutputsGetProductInventoryAvailable" partnerLink="client" operation="getProductInventoryAvailable" portType="tns:SalesOrderProcess" variable="OutputGetProductInventoryAvailableResponse"></bpel:reply>
        <bpel:receive name="ReceiveInputsAddCartItem" partnerLink="client" operation="AddCartItem" portType="tns:SalesOrderProcess" variable="InputAddCartItemRequest">
            <bpel:correlations>
                <bpel:correlation set="CorrelationSet" initiate="no"></bpel:correlation>
            </bpel:correlations>
        </bpel:receive>
        <bpel:if name="If">
            <bpel:condition expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[$isAvailable=true()]]></bpel:condition>
            <bpel:sequence>
                <bpel:assign validate="no" name="AssignInputsAddCartItem">
            <bpel:copy>
                <bpel:from><bpel:literal><impl:addCartItem xmlns:impl="http://addcartitem.ofbiz.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <impl:addCartItemInput>
    <impl:cartId>impl:cartId</impl:cartId>
    <impl:customerId>impl:customerId</impl:customerId>
    <impl:productId>impl:productId</impl:productId>
    <impl:inventoryItemId>impl:inventoryItemId</impl:inventoryItemId>
    <impl:taxClassId>impl:taxClassId</impl:taxClassId>
    <impl:categoryId>impl:categoryId</impl:categoryId>
    <impl:shipAfterDate>impl:shipAfterDate</impl:shipAfterDate>
    <impl:quantity>0.0</impl:quantity>
  </impl:addCartItemInput>
</impl:addCartItem>
</bpel:literal></bpel:from>
                <bpel:to variable="AddCartItemServicePLRequest" part="parameters"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="cartID"></bpel:from>
                <bpel:to part="parameters" variable="AddCartItemServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns3:addCartItemInput/ns3:cartId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="customerID"></bpel:from>
                <bpel:to part="parameters" variable="AddCartItemServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns3:addCartItemInput/ns3:customerId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="productID"></bpel:from>
                <bpel:to part="parameters" variable="AddCartItemServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns3:addCartItemInput/ns3:productId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="inventoryItemID"></bpel:from>
                <bpel:to part="parameters" variable="AddCartItemServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns3:addCartItemInput/ns3:inventoryItemId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="taxClassID"></bpel:from>
                <bpel:to part="parameters" variable="AddCartItemServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns3:addCartItemInput/ns3:taxClassId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="categoryID"></bpel:from>
                <bpel:to part="parameters" variable="AddCartItemServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns3:addCartItemInput/ns3:categoryId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="shipAfterDate"></bpel:from>
                <bpel:to part="parameters" variable="AddCartItemServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns3:addCartItemInput/ns3:shipAfterDate]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="quantity"></bpel:from>
                <bpel:to part="parameters" variable="AddCartItemServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns3:addCartItemInput/ns3:quantity]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
        
            </bpel:assign>
                <bpel:invoke name="InvokeAddCartItem" partnerLink="AddCartItemServicePL" operation="addCartItem" portType="ns3:AddCartItem" inputVariable="AddCartItemServicePLRequest" outputVariable="AddCartItemServicePLResponse"></bpel:invoke>
                <bpel:assign validate="no" name="AssignOutputsAddCartItemTRUE">
            
            
            
            
            
        
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    <bpel:copy>
                        <bpel:from><bpel:literal><tns:AddCartItemResponse xmlns:tns="salesorder" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <tns:CartItemSeqID>tns:CartItemSeqID</tns:CartItemSeqID>
</tns:AddCartItemResponse>
</bpel:literal></bpel:from>
                        <bpel:to variable="OutputAddCartItemResponse" part="parameters"></bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from part="parameters" variable="AddCartItemServicePLResponse">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                <![CDATA[ns3:addCartItemReturn/ns3:cart_item_seq_id]]>
                            </bpel:query>
                        </bpel:from>
                        <bpel:to variable="cartID"></bpel:to>
                    </bpel:copy>
                    <bpel:copy>
                        <bpel:from expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            
                            <![CDATA["Item Added To Cart"]]>
                        </bpel:from>
                        <bpel:to part="parameters" variable="OutputAddCartItemResponse">
                            <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                <![CDATA[tns:CartItemSeqID]]>
                            </bpel:query>
                        </bpel:to>
                    </bpel:copy>
                </bpel:assign>
                <bpel:reply name="ReplyOutputsAddCartItemTRUE" partnerLink="client" operation="AddCartItem" portType="tns:SalesOrderProcess" variable="OutputAddCartItemResponse"></bpel:reply>
                
                
                
                
                
            </bpel:sequence>
            <bpel:else>
                <bpel:sequence>
                    <bpel:assign validate="no" name="AssignOutputsAddCartItemFALSE">
                        
                        <bpel:copy>
                            <bpel:from><bpel:literal><tns:AddCartItemResponse xmlns:tns="salesorder" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <tns:CartItemSeqID>tns:CartItemSeqID</tns:CartItemSeqID>
</tns:AddCartItemResponse>
</bpel:literal></bpel:from>
                            <bpel:to variable="OutputAddCartItemResponse" part="parameters"></bpel:to>
                        </bpel:copy>
                        <bpel:copy>
                            <bpel:from expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                
                                <![CDATA["Product Not Present in Inventory"]]>
                            </bpel:from>
                            <bpel:to part="parameters" variable="OutputAddCartItemResponse">
                                <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                                    <![CDATA[tns:CartItemSeqID]]>
                                </bpel:query>
                            </bpel:to>
                        </bpel:copy>
                    </bpel:assign>
                    <bpel:reply name="ReplyOutputsAddCartItemFALSE" partnerLink="client" operation="AddCartItem" portType="tns:SalesOrderProcess" variable="OutputAddCartItemResponse"></bpel:reply>
                </bpel:sequence>
            </bpel:else>
        </bpel:if>
        
        
        
        
        
        
        
        
        
        
        <bpel:receive name="ReceiveInputsCartShippingSettings" partnerLink="client" operation="UpdateShippingPreference" portType="tns:SalesOrderProcess" variable="InputCartShippingSettingsRequest">
            <bpel:correlations><bpel:correlation set="CorrelationSet" initiate="no"></bpel:correlation>
            
            </bpel:correlations>
                
        </bpel:receive>
        <bpel:assign validate="no" name="AssignInputsCartShippingSettings">
            
            
            
            
            
            
            
            
            
            
            
            
            
            
            <bpel:copy>
                <bpel:from><bpel:literal><impl:updateCartShippingSettings xmlns:impl="http://cartshippingsettings.ofbiz.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <impl:cartShippingSettingsInput>
    <impl:cartId>impl:cartId</impl:cartId>
    <impl:customerId>impl:customerId</impl:customerId>
    <impl:shipToName>impl:shipToName</impl:shipToName>
    <impl:address>impl:address</impl:address>
    <impl:city>impl:city</impl:city>
    <impl:postalCode>impl:postalCode</impl:postalCode>
    <impl:countryGeoId>impl:countryGeoId</impl:countryGeoId>
    <impl:stateProvinceGeoId>impl:stateProvinceGeoId</impl:stateProvinceGeoId>
    <impl:telephone>impl:telephone</impl:telephone>
    <impl:email>impl:email</impl:email>
    <impl:carrierPartyId>impl:carrierPartyId</impl:carrierPartyId>
    <impl:shipmentMethodTypeId>impl:shipmentMethodTypeId</impl:shipmentMethodTypeId>
  </impl:cartShippingSettingsInput>
</impl:updateCartShippingSettings>
</bpel:literal></bpel:from>
                <bpel:to variable="CartShippingSettingsPLRequest" part="parameters"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="InputCartShippingSettingsRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:ShipToName]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="shipToName"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="InputCartShippingSettingsRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:Address]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="address"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="InputCartShippingSettingsRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:City]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="city"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="InputCartShippingSettingsRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:PostalCode]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="postalCode"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="InputCartShippingSettingsRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:CountryGeoID]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="countryGeoID"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="InputCartShippingSettingsRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:StateProvinceGeoID]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="stateProvinceGeoID"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="InputCartShippingSettingsRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:Telephone]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="telephone"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="InputCartShippingSettingsRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:Email]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="email"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="InputCartShippingSettingsRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:CarrierPartyID]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="carrierPartyID"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="InputCartShippingSettingsRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:ShipmentMethodTypeID]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="shipmentMehodTypeID"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="cartID"></bpel:from>
                <bpel:to part="parameters" variable="CartShippingSettingsPLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns4:cartShippingSettingsInput/ns4:cartId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="customerID"></bpel:from>
                <bpel:to part="parameters" variable="CartShippingSettingsPLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns4:cartShippingSettingsInput/ns4:customerId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="shipToName"></bpel:from>
                <bpel:to part="parameters" variable="CartShippingSettingsPLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns4:cartShippingSettingsInput/ns4:shipToName]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="address"></bpel:from>
                <bpel:to part="parameters" variable="CartShippingSettingsPLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns4:cartShippingSettingsInput/ns4:address]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            
            <bpel:copy>
                <bpel:from variable="city"></bpel:from>
                <bpel:to part="parameters" variable="CartShippingSettingsPLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns4:cartShippingSettingsInput/ns4:city]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="countryGeoID"></bpel:from>
                <bpel:to part="parameters" variable="CartShippingSettingsPLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns4:cartShippingSettingsInput/ns4:countryGeoId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="stateProvinceGeoID"></bpel:from>
                <bpel:to part="parameters" variable="CartShippingSettingsPLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns4:cartShippingSettingsInput/ns4:stateProvinceGeoId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="telephone"></bpel:from>
                <bpel:to part="parameters" variable="CartShippingSettingsPLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns4:cartShippingSettingsInput/ns4:telephone]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="email"></bpel:from>
                <bpel:to part="parameters" variable="CartShippingSettingsPLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns4:cartShippingSettingsInput/ns4:email]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="carrierPartyID"></bpel:from>
                <bpel:to part="parameters" variable="CartShippingSettingsPLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns4:cartShippingSettingsInput/ns4:carrierPartyId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="shipmentMehodTypeID"></bpel:from>
                <bpel:to part="parameters" variable="CartShippingSettingsPLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns4:cartShippingSettingsInput/ns4:shipmentMethodTypeId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
        
                
        </bpel:assign>
        <bpel:invoke name="InvokeCartShippingSettings" partnerLink="CartShippingSettingsPL" operation="updateCartShippingSettings" portType="ns4:CartShippingSettings" inputVariable="CartShippingSettingsPLRequest" outputVariable="CartShippingSettingsPLResponse"></bpel:invoke>
        <bpel:assign validate="no" name="AssignOutputsCartShippingSettings">
            <bpel:copy><bpel:from><bpel:literal><tns:UpdateShippingPreferenceResponse xmlns:tns="salesorder" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <tns:ResponseMessage>tns:ResponseMessage</tns:ResponseMessage>
</tns:UpdateShippingPreferenceResponse>
</bpel:literal></bpel:from>
                <bpel:to variable="OutputCartShippingSettingsResponse" part="parameters"></bpel:to>
            
            </bpel:copy><bpel:copy>
                <bpel:from part="parameters" variable="CartShippingSettingsPLResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[ns4:updateCartShippingSettingsReturn/ns4:responseMessage]]></bpel:query>
                </bpel:from>
                <bpel:to part="parameters" variable="OutputCartShippingSettingsResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:ResponseMessage]]></bpel:query>
                </bpel:to>
            </bpel:copy>
        
                
        </bpel:assign>
        <bpel:reply name="ReplyOutputsCartShippingSettings" partnerLink="client" operation="UpdateShippingPreference" portType="tns:SalesOrderProcess" variable="OutputCartShippingSettingsResponse"></bpel:reply>
        <bpel:receive name="ReceiveInputsUpdateCartPaymentPreference" partnerLink="client" operation="updateCartPaymentPreference" portType="tns:SalesOrderProcess" variable="InputUpdateCartPaymentPreferenceRequest">
            <bpel:correlations>
                <bpel:correlation set="CorrelationSet" initiate="no"></bpel:correlation>
            </bpel:correlations>
        </bpel:receive>
        <bpel:assign validate="no" name="AssignInputsUpdateCartPaymentPreference">
            <bpel:copy>
                <bpel:from><bpel:literal><impl:updateCartPaymentPreference xmlns:impl="http://cartpaymentpreference.ofbiz.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <impl:cartPaymentPreferenceInput>
    <impl:cartId>impl:cartId</impl:cartId>
    <impl:customerId>impl:customerId</impl:customerId>
    <impl:firstName>impl:firstName</impl:firstName>
    <impl:lastName>impl:lastName</impl:lastName>
    <impl:currencyUom>impl:currencyUom</impl:currencyUom>
    <impl:issueNumber>impl:issueNumber</impl:issueNumber>
    <impl:cardNumber>impl:cardNumber</impl:cardNumber>
    <impl:cardType>impl:cardType</impl:cardType>
    <impl:expYear>impl:expYear</impl:expYear>
    <impl:expMonth>impl:expMonth</impl:expMonth>
    <impl:paymentMethod>impl:paymentMethod</impl:paymentMethod>
  </impl:cartPaymentPreferenceInput>
</impl:updateCartPaymentPreference>
</bpel:literal></bpel:from>
                <bpel:to variable="UpdateCartPaymentPreferencePLRequest" part="parameters"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="InputUpdateCartPaymentPreferenceRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:Currency]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="currency"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="InputUpdateCartPaymentPreferenceRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:IssueNumber]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="issueNumber"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="InputUpdateCartPaymentPreferenceRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:CardNumber]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="cardNumber"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="InputUpdateCartPaymentPreferenceRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:CardType]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="cardType"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="InputUpdateCartPaymentPreferenceRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:ExpirationYear]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="expirationYear"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="InputUpdateCartPaymentPreferenceRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:ExpirationMonth]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="expirationMonth"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="InputUpdateCartPaymentPreferenceRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:PaymentMethod]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="paymentMethod"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="cartID"></bpel:from>
                <bpel:to part="parameters" variable="UpdateCartPaymentPreferencePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns5:cartPaymentPreferenceInput/ns5:cartId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            
            <bpel:copy>
                <bpel:from variable="customerID"></bpel:from>
                <bpel:to part="parameters" variable="UpdateCartPaymentPreferencePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns5:cartPaymentPreferenceInput/ns5:customerId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="firstName"></bpel:from>
                <bpel:to part="parameters" variable="UpdateCartPaymentPreferencePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns5:cartPaymentPreferenceInput/ns5:firstName]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="lastName"></bpel:from>
                <bpel:to part="parameters" variable="UpdateCartPaymentPreferencePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns5:cartPaymentPreferenceInput/ns5:lastName]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="currency"></bpel:from>
                <bpel:to part="parameters" variable="UpdateCartPaymentPreferencePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns5:cartPaymentPreferenceInput/ns5:currencyUom]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="issueNumber"></bpel:from>
                <bpel:to part="parameters" variable="UpdateCartPaymentPreferencePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns5:cartPaymentPreferenceInput/ns5:issueNumber]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="cardNumber"></bpel:from>
                <bpel:to part="parameters" variable="UpdateCartPaymentPreferencePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns5:cartPaymentPreferenceInput/ns5:cardNumber]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="cardType"></bpel:from>
                <bpel:to part="parameters" variable="UpdateCartPaymentPreferencePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns5:cartPaymentPreferenceInput/ns5:cardType]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="expirationYear"></bpel:from>
                <bpel:to part="parameters" variable="UpdateCartPaymentPreferencePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns5:cartPaymentPreferenceInput/ns5:expYear]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="expirationMonth"></bpel:from>
                <bpel:to part="parameters" variable="UpdateCartPaymentPreferencePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns5:cartPaymentPreferenceInput/ns5:expMonth]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            
            <bpel:copy>
                <bpel:from variable="paymentMethod"></bpel:from>
                <bpel:to part="parameters" variable="UpdateCartPaymentPreferencePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns5:cartPaymentPreferenceInput/ns5:paymentMethod]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
        </bpel:assign>
        <bpel:invoke name="InvokeUpdateCartPaymentPreference" partnerLink="UpdateCartPaymentPreferencePL" operation="updateCartPaymentPreference" portType="ns5:CartPaymentPreference" inputVariable="UpdateCartPaymentPreferencePLRequest" outputVariable="UpdateCartPaymentPreferencePLResponse"></bpel:invoke>
        <bpel:assign validate="no" name="AssignOutputsUpdateCartPaymentPreference">
            <bpel:copy>
                <bpel:from><bpel:literal><tns:updateCartPaymentPreferenceResponse xmlns:tns="salesorder" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <tns:ResponseMessage>tns:ResponseMessage</tns:ResponseMessage>
</tns:updateCartPaymentPreferenceResponse>
</bpel:literal></bpel:from>
                <bpel:to variable="OutputUpdateCartPaymentPreferenceResponse" part="parameters"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="UpdateCartPaymentPreferencePLResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[ns5:updateCartPaymentPreferenceReturn/ns5:responseMessage]]></bpel:query>
                </bpel:from>
                <bpel:to part="parameters" variable="OutputUpdateCartPaymentPreferenceResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:ResponseMessage]]></bpel:query>
                </bpel:to>
            </bpel:copy>
        </bpel:assign>
        <bpel:reply name="ReplyOutputsUpdateCartPaymentPreference" partnerLink="client" operation="updateCartPaymentPreference" portType="tns:SalesOrderProcess" variable="OutputUpdateCartPaymentPreferenceResponse"></bpel:reply>
        <bpel:receive name="ReceiveInputCalculateSalesTax" partnerLink="client" operation="calcualateSalesTax" portType="tns:SalesOrderProcess" variable="InputCalculateSalesTaxRequest">
            <bpel:correlations>
                <bpel:correlation set="CorrelationSet" initiate="no"></bpel:correlation>
            </bpel:correlations>
        </bpel:receive>
        <bpel:assign validate="no" name="AssignInputsCalculateSalesTax">
            <bpel:copy>
                <bpel:from><bpel:literal><impl:calculateSalesTax xmlns:impl="http://taxServices.sample.ws" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <impl:in>
    <impl:taxClassId>impl:taxClassId</impl:taxClassId>
    <impl:categoryId>impl:categoryId</impl:categoryId>
    <impl:quantity>0.0</impl:quantity>
    <impl:price>0.0</impl:price>
    <impl:shipping_address_id>impl:shipping_address_id</impl:shipping_address_id>
  </impl:in>
</impl:calculateSalesTax>
</bpel:literal></bpel:from>
                <bpel:to variable="CalculateSalesTaxServicePLRequest" part="parameters"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="taxClassID"></bpel:from>
                <bpel:to part="parameters" variable="CalculateSalesTaxServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[ns6:in/ns6:taxClassId]]></bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="categoryID"></bpel:from>
                <bpel:to part="parameters" variable="CalculateSalesTaxServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns6:in/ns6:categoryId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="quantity"></bpel:from>
                <bpel:to part="parameters" variable="CalculateSalesTaxServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns6:in/ns6:quantity]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="price"></bpel:from>
                <bpel:to part="parameters" variable="CalculateSalesTaxServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns6:in/ns6:price]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="postalCode"></bpel:from>
                <bpel:to part="parameters" variable="CalculateSalesTaxServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns6:in/ns6:shipping_address_id]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
        </bpel:assign>
        <bpel:invoke name="InvokeCalculateSalesTaxService" partnerLink="CalculateSalesTaxServicePL" operation="calculateSalesTax" portType="ns6:CalculateSalesTax" inputVariable="CalculateSalesTaxServicePLRequest" outputVariable="CalculateSalesTaxServicePLResponse"></bpel:invoke>
        <bpel:assign validate="no" name="AssignOutputsCalculateSalesTax">
            
            
            
            
            
            
            
            
            
            
            <bpel:copy>
                <bpel:from><bpel:literal><tns:calcualateSalesTaxResponse xmlns:tns="salesorder" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <tns:TaxAmount>tns:TaxAmount</tns:TaxAmount>
  <tns:TaxRate>tns:TaxRate</tns:TaxRate>
</tns:calcualateSalesTaxResponse>
</bpel:literal></bpel:from>
                <bpel:to variable="OutputCalculateSalesTaxResponse" part="parameters"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="CalculateSalesTaxServicePLResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns6:calculateSalesTaxReturn/ns6:taxAmount]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="TaxAmount"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="CalculateSalesTaxServicePLResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns6:calculateSalesTaxReturn/ns6:taxRate]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="TaxRate"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="TaxAmount"></bpel:from>
                <bpel:to part="parameters" variable="OutputCalculateSalesTaxResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:TaxAmount]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="TaxRate"></bpel:from>
                <bpel:to part="parameters" variable="OutputCalculateSalesTaxResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:TaxRate]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
        </bpel:assign>
        <bpel:reply name="ReplyOutputCalculateSalesTax" partnerLink="client" operation="calcualateSalesTax" portType="tns:SalesOrderProcess" variable="OutputCalculateSalesTaxResponse"></bpel:reply>
        <bpel:receive name="ReceiveInputsCalculateShipping" partnerLink="client" operation="calculateShipping" portType="tns:SalesOrderProcess" variable="InputCalculateShippingRequest">
            <bpel:correlations>
                <bpel:correlation set="CorrelationSet" initiate="no"></bpel:correlation>
            </bpel:correlations>
        </bpel:receive>
        <bpel:assign validate="no" name="AssignInputsCalculateShipping">
            <bpel:copy>
                <bpel:from><bpel:literal><impl:calc_shipping xmlns:impl="http://shippingServices.sample.ws" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <impl:in>
    <impl:cartId>impl:cartId</impl:cartId>
    <impl:carrierId>impl:carrierId</impl:carrierId>
    <impl:shipmentMethodTypeId>impl:shipmentMethodTypeId</impl:shipmentMethodTypeId>
    <impl:shipping_address>impl:shipping_address</impl:shipping_address>
  </impl:in>
</impl:calc_shipping>
</bpel:literal></bpel:from>
                <bpel:to variable="CalculateShippingServicePLRequest" part="parameters"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="cartID"></bpel:from>
                <bpel:to part="parameters" variable="CalculateShippingServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns7:in/ns7:cartId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="carrierPartyID"></bpel:from>
                <bpel:to part="parameters" variable="CalculateShippingServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns7:in/ns7:carrierId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="shipmentMehodTypeID"></bpel:from>
                <bpel:to part="parameters" variable="CalculateShippingServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns7:in/ns7:shipmentMethodTypeId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="address"></bpel:from>
                <bpel:to part="parameters" variable="CalculateShippingServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns7:in/ns7:shipping_address]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
        </bpel:assign>
        <bpel:invoke name="InvokeCalculateShippingService" partnerLink="CalculateShippingServicePL" operation="calc_shipping" portType="ns7:ShippingService" inputVariable="CalculateShippingServicePLRequest" outputVariable="CalculateShippingServicePLResponse"></bpel:invoke>
        <bpel:assign validate="no" name="AssignOutputsCalculateShippingService">
            <bpel:copy>
                <bpel:from><bpel:literal><tns:calculateShippingResponse xmlns:tns="salesorder" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <tns:ShipmentCostEstimate>tns:ShipmentCostEstimate</tns:ShipmentCostEstimate>
</tns:calculateShippingResponse>
</bpel:literal></bpel:from>
                <bpel:to variable="OutputCalculateShippingResponse" part="parameters"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="CalculateShippingServicePLResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns7:calc_shippingReturn/ns7:shipment_costEstimate]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="shipmentCostEstimate"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="shipmentCostEstimate"></bpel:from>
                <bpel:to part="parameters" variable="OutputCalculateShippingResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[tns:ShipmentCostEstimate]]></bpel:query>
                </bpel:to>
            </bpel:copy>
        </bpel:assign>
        <bpel:reply name="ReplyOutputsCalculateShipping" partnerLink="client" operation="calculateShipping" portType="tns:SalesOrderProcess" variable="OutputCalculateShippingResponse"></bpel:reply>
        <bpel:receive name="ReceiveInputsGetCartContent" partnerLink="client" operation="getCartContent" portType="tns:SalesOrderProcess" variable="InputGetCartContentRequest">
            <bpel:correlations>
                <bpel:correlation set="CorrelationSet" initiate="no"></bpel:correlation>
            </bpel:correlations>
        </bpel:receive>
        <bpel:assign validate="no" name="AssignInputsGetCartContent">
            <bpel:copy>
                <bpel:from><bpel:literal><impl:getCartContents xmlns:impl="http://getcartcontents.ofbiz.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <impl:getCartContentsInput>
    <impl:cartId>impl:cartId</impl:cartId>
  </impl:getCartContentsInput>
</impl:getCartContents>
</bpel:literal></bpel:from>
                <bpel:to variable="GetCartContentServicePLRequest" part="parameters"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="cartID"></bpel:from>
                <bpel:to part="parameters" variable="GetCartContentServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns8:getCartContentsInput/ns8:cartId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
        </bpel:assign>
        <bpel:invoke name="InvokeGetCartContent" partnerLink="GetCartContentServicePL" operation="getCartContents" portType="ns8:GetCartContents" inputVariable="GetCartContentServicePLRequest" outputVariable="GetCartContentServicePLResponse"></bpel:invoke>
        <bpel:assign validate="no" name="AssignOutputsGetCartContent">
            
            
            <bpel:copy>
                <bpel:from><bpel:literal><tns:getCartContentResponse xmlns:tns="salesorder" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <tns:CartItems>tns:CartItems</tns:CartItems>
</tns:getCartContentResponse>
</bpel:literal></bpel:from>
                <bpel:to variable="OutputGetCartContentResponse" part="parameters"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                    <![CDATA[count($GetCartContentServicePLResponse.parameters/ns8:getCartContentsReturn/ns8:cartItems)]]>
                </bpel:from>
                <bpel:to variable="count"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="count"></bpel:from>
                <bpel:to part="parameters" variable="OutputGetCartContentResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:CartItems]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
        </bpel:assign>
        <bpel:reply name="ReplyOutputsGetCartContent" partnerLink="client" operation="getCartContent" portType="tns:SalesOrderProcess" variable="OutputGetCartContentResponse"></bpel:reply>
        <bpel:receive name="ReceiveInputsCreateOrder" partnerLink="client" operation="createOrder" portType="tns:SalesOrderProcess" variable="InputCreateOrderRequest">
            <bpel:correlations>
                <bpel:correlation set="CorrelationSet" initiate="no"></bpel:correlation>
            </bpel:correlations>
        </bpel:receive>
        <bpel:assign validate="no" name="AssignInputsCreateOrder">
            <bpel:copy>
                <bpel:from><bpel:literal><impl:createOrder xmlns:impl="http://createCustomerOrder.ofbiz.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <impl:createOrderForCustomerInput>
    <impl:cartId>impl:cartId</impl:cartId>
    <impl:customerId>impl:customerId</impl:customerId>
    <impl:taxAmount>0.0</impl:taxAmount>
    <impl:shipmentCharges>0.0</impl:shipmentCharges>
  </impl:createOrderForCustomerInput>
</impl:createOrder>
</bpel:literal></bpel:from>
                <bpel:to variable="CreateOrderServicePLRequest" part="parameters"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="cartID"></bpel:from>
                <bpel:to part="parameters" variable="CreateOrderServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns9:createOrderForCustomerInput/ns9:cartId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            
            
            <bpel:copy>
                <bpel:from variable="customerID"></bpel:from>
                <bpel:to part="parameters" variable="CreateOrderServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns9:createOrderForCustomerInput/ns9:customerId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="TaxAmount"></bpel:from>
                <bpel:to part="parameters" variable="CreateOrderServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns9:createOrderForCustomerInput/ns9:taxAmount]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="shipmentCostEstimate"></bpel:from>
                <bpel:to part="parameters" variable="CreateOrderServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns9:createOrderForCustomerInput/ns9:shipmentCharges]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
        </bpel:assign>
        <bpel:invoke name="InvokeCreateOrder" partnerLink="CreateOrderServicePL" operation="createOrder" portType="ns9:CreateOrder" inputVariable="CreateOrderServicePLRequest" outputVariable="CreateOrderServicePLResponse"></bpel:invoke>
        <bpel:assign validate="no" name="AssignOutputsCreateOrder">
            <bpel:copy>
                <bpel:from><bpel:literal><tns:createOrderResponse xmlns:tns="salesorder" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <tns:OrderID>tns:OrderID</tns:OrderID>
  <tns:StatusID>tns:StatusID</tns:StatusID>
</tns:createOrderResponse>
</bpel:literal></bpel:from>
                <bpel:to variable="OutputCreateOrderResponse" part="parameters"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="CreateOrderServicePLResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns9:createOrderReturn/ns9:orderId]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="orderID"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="CreateOrderServicePLResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns9:createOrderReturn/ns9:statusId]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="statusID"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="orderID"></bpel:from>
                <bpel:to part="parameters" variable="OutputCreateOrderResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:OrderID]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="statusID"></bpel:from>
                <bpel:to part="parameters" variable="OutputCreateOrderResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:StatusID]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
        </bpel:assign>
        <bpel:reply name="ReplyOutputsCreateOrder" partnerLink="client" operation="createOrder" portType="tns:SalesOrderProcess" variable="OutputCreateOrderResponse"></bpel:reply>
        <bpel:receive name="ReceiveInputsCreateInvoice" partnerLink="client" operation="createInvoice" portType="tns:SalesOrderProcess" variable="InputCreateInvoiceRequest">
            <bpel:correlations>
                <bpel:correlation set="CorrelationSet" initiate="no"></bpel:correlation>
            </bpel:correlations>
        </bpel:receive>
        
        <bpel:assign validate="no" name="AssignInputsCreateInvoice">
            <bpel:copy>
                <bpel:from><bpel:literal><impl:createInvoice xmlns:impl="http://createinvoice.ofbiz.com" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <impl:createInvoiceInput>
    <impl:orderId>impl:orderId</impl:orderId>
    <impl:statusId>impl:statusId</impl:statusId>
    <impl:partyIdFrom>impl:partyIdFrom</impl:partyIdFrom>
    <impl:taxAmount>0.0</impl:taxAmount>
    <impl:shippingCharges>0.0</impl:shippingCharges>
    <impl:totalAmount>0.0</impl:totalAmount>
  </impl:createInvoiceInput>
</impl:createInvoice>
</bpel:literal></bpel:from>
                <bpel:to variable="CreatInvoiceServicePLRequest" part="parameters"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="orderID"></bpel:from>
                <bpel:to part="parameters" variable="CreatInvoiceServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns10:createInvoiceInput/ns10:orderId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="statusID"></bpel:from>
                <bpel:to part="parameters" variable="CreatInvoiceServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns10:createInvoiceInput/ns10:statusId]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="customerID"></bpel:from>
                <bpel:to part="parameters" variable="CreatInvoiceServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns10:createInvoiceInput/ns10:partyIdFrom]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="TaxAmount"></bpel:from>
                <bpel:to part="parameters" variable="CreatInvoiceServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns10:createInvoiceInput/ns10:taxAmount]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="shipmentCostEstimate"></bpel:from>
                <bpel:to part="parameters" variable="CreatInvoiceServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns10:createInvoiceInput/ns10:shippingCharges]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            
            <bpel:copy>
                <bpel:from expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    
                    <![CDATA[$TaxAmount + $shipmentCostEstimate]]>
                </bpel:from>
                <bpel:to variable="totalAmount"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="totalAmount"></bpel:from>
                <bpel:to part="parameters" variable="CreatInvoiceServicePLRequest">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns10:createInvoiceInput/ns10:totalAmount]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
        </bpel:assign>
        <bpel:invoke name="InvokeCreateInvoice" partnerLink="CreatInvoiceServicePL" operation="createInvoice" portType="ns10:CreateInvoice" inputVariable="CreatInvoiceServicePLRequest" outputVariable="CreatInvoiceServicePLResponse"></bpel:invoke>
        <bpel:assign validate="no" name="AssignOutputsCreateInvoice">
            
            
            
            
            
            
            
            
            
            <bpel:copy>
                <bpel:from><bpel:literal><tns:createInvoiceResponse xmlns:tns="salesorder" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
  <tns:InvoiceID>tns:InvoiceID</tns:InvoiceID>
  <tns:InvoiceDate>tns:InvoiceDate</tns:InvoiceDate>
</tns:createInvoiceResponse>
</bpel:literal></bpel:from>
                <bpel:to variable="OutputCreateInvoiceResponse" part="parameters"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="CreatInvoiceServicePLResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[ns10:createInvoiceReturn/ns10:invoiceId]]>
                    </bpel:query>
                </bpel:from>
                <bpel:to variable="invoiceID"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from part="parameters" variable="CreatInvoiceServicePLResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0"><![CDATA[ns10:createInvoiceReturn/ns10:invoiceDate]]></bpel:query>
                </bpel:from>
                <bpel:to variable="invoiceDate"></bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="invoiceID"></bpel:from>
                <bpel:to part="parameters" variable="OutputCreateInvoiceResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:InvoiceID]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
            <bpel:copy>
                <bpel:from variable="invoiceDate"></bpel:from>
                <bpel:to part="parameters" variable="OutputCreateInvoiceResponse">
                    <bpel:query queryLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                        <![CDATA[tns:InvoiceDate]]>
                    </bpel:query>
                </bpel:to>
            </bpel:copy>
        </bpel:assign>
        <bpel:reply name="ReplyOutputsCreateInvoice" partnerLink="client" operation="createInvoice" portType="tns:SalesOrderProcess" variable="OutputCreateInvoiceResponse"></bpel:reply>
    </bpel:sequence>
</bpel:process>

